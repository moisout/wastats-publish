!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t=t||self).whatsappChatParser={})}(this,function(t){"use strict";function y(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var r=[],e=!0,u=!1,a=void 0;try{for(var o,i=t[Symbol.iterator]();!(e=(o=i.next()).done)&&(r.push(o.value),!n||r.length!==n);e=!0);}catch(t){u=!0,a=t}finally{try{e||null==i.return||i.return()}finally{if(u)throw a}}return r}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var n=function(n,r){return function(t){return t[n]>r}},a=function(t){return t<0},r=function(t,e){return Object.values(t.reduce(function(t,n){var r="key_".concat(n[e]);return t[r]||(t[r]=[]),t[r].push(n),t},{}))};function e(t){return!!t.some(n(0,12))||!t.some(n(1,12))&&null}function u(t){var n=r(t,2).map(function(u){return!!u.slice(1).some(function(t,n){var r=y(u[n],1)[0],e=y(t,1)[0];return a(e-r)})||!u.slice(1).some(function(t,n){var r=y(u[n],2)[1],e=y(t,2)[1];return a(e-r)})&&null});return!!n.some(function(t){return!0===t})||!n.some(function(t){return!1===t})&&null}function o(e){var t=y(e.slice(1).map(function(t,r){return t.map(function(t,n){return Math.abs(e[r][n]-t)})}).reduce(function(t,n){var r=y(t,2),e=r[0],u=r[1],a=y(n,2);return[e+a[0],u+a[1]]},[0,0]),2),n=t[0],r=t[1];return r<n||!(n<r)&&null}var i=/[:.]/;var c=function(t){var n=e(t);if(null!==n)return n;var r=u(t);return null!==r?r:o(t)},g=function(t,n,r){return[t.padStart(4,"2000"),n.padStart(2,"0"),r.padStart(2,"0")]},S=i,b=function(t,n){var r=y(t.split(i),3),e=r[0],u=r[1],a=r[2];return"12"===e&&(e="00"),"PM"===n&&(e=parseInt(e,10)+12),"".concat(e,":").concat(u).concat(a?":".concat(a):"")},w=function(t){return t.replace(/[^apm]/gi,"").toUpperCase()},x=function(t){var n=y(t.split(i),3),r=n[0],e=n[1],u=n[2];return"".concat(1===r.length?"0".concat(r):r,":").concat(e,":").concat(u||"00")},s=/\[?(\d{1,2}[-/.] ?\d{1,2}[-/.] ?\d{2,4})[,.]? \D*?(\d{1,2}[.:]\d{1,2}(?:[.:]\d{1,2})?)(?: ([ap]\.?m\.?))?\]?(?: -|:)? (.+?): ([^]*)/i,f=/\[?(\d{1,2}[-/.] ?\d{1,2}[-/.] ?\d{2,4})[,.]? \D*?(\d{1,2}[.:]\d{1,2}(?:[.:]\d{1,2})?)(?: ([ap]\.?m\.?))?\]?(?: -|:)? ([^]+)/i,l=/\[?(\d{1,2}[-/.] ?\d{1,2}[-/.] ?\d{2,4})[,.]? \D*?(\d{1,2}[.:]\d{1,2}(?:[.:]\d{1,2})?)(?: ([ap]\.?m\.?))?\]?/i,D=/[-/.] ?/;function p(t){return t.reduce(function(t,n){if(s.test(n))t.push({system:!1,msg:n});else if(l.test(n))t.push({system:!0,msg:n});else if(void 0!==t[t.length-1]){var r=t.pop();t.push({system:r.system,msg:"".concat(r.msg,"\n").concat(n)})}return t},[])}var d=function(t){var h=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{daysFirst:void 0}).daysFirst,n=t.map(function(t){var n=t.system,r=t.msg;if(n){var e=y(f.exec(r),5);return{date:e[1],time:e[2],ampm:e[3]||null,author:"System",message:e[4]}}var u=y(s.exec(r),6);return{date:u[1],time:u[2],ampm:u[3]||null,author:u[4],message:u[5]}});if("boolean"!=typeof h){var r=Array.from(new Set(n.map(function(t){return t.date})),function(t){return t.split(D).map(Number)});h=c(r)}return n.map(function(t){var n,r,e,u=t.date,a=t.time,o=t.ampm,i=t.author,c=t.message;if(!1===h){var s=y(u.split(D),3);r=s[0],n=s[1],e=s[2]}else{var f=y(u.split(D),3);n=f[0],r=f[1],e=f[2]}var l=y(g(e,r,n),3);e=l[0],r=l[1],n=l[2];var p=y(x(o?b(a,w(o)):a).split(S),3),d=p[0],m=p[1],v=p[2];return{date:new Date(e,r-1,n,d,m,v),author:i,message:c}})};var m={parseString:function(t,n){return Promise.resolve(t).then(function(t){return t.split("\n")}).then(p).then(function(t){return d(t,n)})}},v=m.parseString;t.default=m,t.parseString=v,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=whatsapp-chat-parser.min.js.map
